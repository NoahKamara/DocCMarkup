<!-- 3a212849-274a-4251-8234-05b8b262eaa3 08d77bc2-5be0-4f53-9c80-756960f981d7 -->
# DocCMarkup: Parsing/API hardening and docs

## Phase 1 — Parsing/API adjustments

- ~~Public initializer: expose `DocumentationMarkup.init(markup:upToSection:)`, rename `ParserSection` → `ParseSection`, `discussionTags` → `tags` (update call sites and tests).~~
- ~~Remove the unused parameter: drop `removeLeadingTrivia` from `DocumentationMarkup.init(parsing:)`.~~
- ~~Robust doc-comment trimming:~~
- ~~Line comments: accept `///` with/without trailing space and tabs; trim uniformly per line.~~
- ~~Block comments: strip `/** ... */` wrapper and a leading `*` per line + surrounding whitespace.~~
- Title/abstract/discussion semantics: keep current behavior for symbol docs (first paragraph = abstract, remainder = discussion); document this explicitly in type docs.
- ~~Prefer slicing over manual iteration in `Markup.children(at:)` if supported; otherwise, keep helpers but simplify.~~

Files:

- `Sources/DocCMarkup/DocumentationMarkup.swift`
- `Sources/DocCMarkup/DocumentationMarkup+Parsing.swift`

## Phase 2 — Tagged components and asides

- ~~Support more asides at top-level list: Note, Important, Warning, Tip, SeeAlso (convert to `BlockQuote` equivalents after the filtered list).~~
- ~~Make `TaggedComponents` properties public read-only (via `public private(set)` or computed accessors).~~
- Keep “other” tags as `SimpleTag` and document intended scope.
- Revisit naming: align with the `tags` property on `DocumentationMarkup`.

Files:

- `Sources/DocCMarkup/Components/TaggedComponents.swift`

## Phase 3 — HTTP parsing improvements

- `HTTPResponse` parsing:
- Parse status code and reason from tags like `- HTTPResponse 200 OK:`; set `statusCode: UInt?` (nil if non-numeric) and `reason` when present; skip entry when neither parse is meaningful.
- `HTTPParameter` parsing:
- Recognize simple source hints like `query`, `path`, `header` and required markers like `(required)`; populate `source`/`required` heuristically when present, otherwise leave nil/false.

Files:

- `Sources/DocCMarkup/Components/TaggedComponents.swift`
- `Sources/DocCMarkup/Components/HTTPResponse.swift`
- `Sources/DocCMarkup/Components/HTTPParameter.swift`

## Phase 4 — Conformances and access control polish

- Add `Sendable` to public value types where feasible (`AbstractSection`, `DiscussionSection`, `Parameter`, `ParametersSection`, `Return`, `ReturnsSection`, `Throw`, `HTTPBody`, `HTTPParameter`, `HTTPResponse`, `TaggedComponents`).
- Ensure public initializers/props have the intended visibility; avoid exposing mutation where not needed.

Files:

- `Sources/DocCMarkup/Components/*`
- `Sources/DocCMarkup/DocumentationMarkup.swift`

## Phase 5 — Package hygiene

- Pin dependency versions (avoid `branch: "main"` for `swift-markdown` and `swift-docc-symbolkit`).
- Remove macro target fully: keep commented-out target removed and delete/ignore `Sources/DocCMarkupMacros/*` (no macros in this package).
- Leave `VyperTests` as is locally (not committed) — no package changes needed.

Files:

- `Package.swift`
- Remove `Sources/DocCMarkupMacros/` or exclude

## Phase 6 — Documentation

- Add/expand type-level docs:
- `DocumentationMarkup` initializers documenting abstract/discussion rules.
- `TaggedComponents` overview documenting supported tags and asides.
- `DiscussionSection.format()` summary.
- Add `README.md` describing scope: DocC symbol docs supported, other DocC constructs not parsed; usage examples and expected JSON shape for common tags.

Files:

- `Sources/DocCMarkup/**/*.swift` (doc comments)
- `README.md`

## Phase 7 — Tests

- Extend parsing tests:
- Line doc comments with and without trailing spaces and with tabs.
- Block comments with leading `*` per line.
- Asides: Note/Important/Warning/Tip/SeeAlso transformation behavior.
- HTTP response parsing with numeric/non-numeric codes and reason phrases.
- HTTP parameter source/required heuristics.
- Update snapshots to reflect renamed `tags` and API changes.

Files:

- `Tests/DocCMarkupTests/ParsingTests.swift`

## Notes

- No macros: delete plugin code or move it out of the package target tree.
- Keep markdown content otherwise untouched; only DocC symbol docs receive structured parsing.

### To-dos

- [x] Expose public init, rename types/props, drop removeLeadingTrivia
- [x] Robustly trim line/block doc-comments
- [x] Support Note/Important/Warning/Tip/SeeAlso asides
- [x] Make TaggedComponents props public read-only, add docs
- [ ] Parse status code/reason; make statusCode optional
- [ ] Infer source and required flags when present
- [ ] Add Sendable to public value types
- [x] Prefer slicing over manual children iteration
- [ ] Pin swift-markdown and symbolkit; remove macro target
- [ ] Add README and type-level docs with examples
- [ ] Add/adjust tests for trimming, asides, HTTP, and API rename